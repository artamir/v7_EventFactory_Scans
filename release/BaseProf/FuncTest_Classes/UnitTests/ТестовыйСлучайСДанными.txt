
Процедура Сетап() Экспорт
	НачатьТранзакцию();
КонецПроцедуры

Процедура Сброс() Экспорт
	ОтменитьТранзакцию();
КонецПроцедуры


Функция ПровестиДокументШпионом(_Документ, СообщенияПроведения) Экспорт
	// Полезная функция для отлова сообщений, выдаваемых 1С-м о причине непроведенности документа.
	
	Попытка
		Шпион = СоздатьОбъект("Шпион1С");
	Исключение
		ЗагрузитьВнешнююКомпоненту("1spy.dll");
		Шпион = СоздатьОбъект("Шпион1С");
	КонецПопытки;
	Шпион.ОчиститьБуфер();
	РезультатПроведения = _Документ.Провести();
	СообщенияПроведения = Шпион.ПолучитьИзБуфера();
	
	Возврат РезультатПроведения;
КонецФункции
